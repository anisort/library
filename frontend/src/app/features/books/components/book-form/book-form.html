<div class="book-form-container">
  @if (isLoading) {
    <app-loader></app-loader>
  } @else {
    <form [formGroup]="bookForm" (ngSubmit)="onSubmit()">
      <h3>{{ isEditMode ? 'Update Book' : 'Create Book' }}</h3>

      @if (coverPreview) {
        <img
          id="preview"
          [src]="coverPreview"
          alt="Cover preview"
          width="200"
          height="300" />
      }

      <div class="field">
        <label for="file">Cover File:</label>
        <input type="file" id="file" (change)="onFileChange($event)" />
        @if (isEditMode && bookForm.get('file')?.errors?.['required'] && bookForm.get('file')?.touched) {
          <small class="error">File is required.</small>
        }
      </div>

      <div class="field">
        <label for="title">Title:</label>
        <input type="text" id="title" formControlName="title" />
        @if (bookForm.get('title')?.errors?.['required'] && bookForm.get('title')?.touched) {
          <small class="error">Title is required.</small>
        }
        @if (bookForm.get('title')?.errors?.['minlength'] && bookForm.get('title')?.touched) {
          <small class="error">Title must be at least 3 characters.</small>
        }
      </div>

      <div class="field">
        <label for="author">Author:</label>
        <input type="text" id="author" formControlName="author" />
        @if (bookForm.get('author')?.errors?.['required'] && bookForm.get('author')?.touched) {
          <small class="error">Author is required.</small>
        }
        @if (bookForm.get('author')?.errors?.['minlength'] && bookForm.get('author')?.touched) {
          <small class="error">Author must be at least 3 characters.</small>
        }
      </div>

      <div class="field">
        <label for="summary">Summary:</label>
        <textarea id="summary" formControlName="summary"></textarea>
        @if (bookForm.get('summary')?.errors?.['required'] && bookForm.get('summary')?.touched) {
          <small class="error">Summary is required.</small>
        }
        @if (bookForm.get('summary')?.errors?.['minlength'] && bookForm.get('summary')?.touched) {
          <small class="error">Summary must be at least 3 characters.</small>
        }
      </div>

      <div class="field">
        <label for="link">External Link:</label>
        <input type="text" id="link" formControlName="link" />
        @if (bookForm.get('link')?.errors?.['required'] && bookForm.get('link')?.touched) {
          <small class="error">Link is required.</small>
        }
      </div>

      <button id="submit-btn" type="submit" [disabled]="bookForm.invalid">
        {{ isEditMode ? 'Update' : 'Create' }}
      </button>
    </form>
  }
</div>
